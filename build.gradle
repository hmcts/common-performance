plugins {
    id 'scala'
    id 'java-library'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'io.gatling:gatling-core:3.9.5'
    implementation 'org.scala-lang:scala-library:2.13.10'
    implementation 'com.google.code.gson:gson:2.10.1'
    testImplementation 'org.scalatest:scalatest_2.13:3.2.17'

    constraints {
        implementation 'io.netty:netty-handler:4.1.108.Final'
        implementation 'io.netty:netty-transport:4.1.108.Final'
        implementation 'io.netty:netty-codec:4.1.108.Final'
        implementation 'ch.qos.logback:logback-classic:1.4.11'
        implementation 'ch.qos.logback:logback-core:1.4.11'
        implementation 'com.fasterxml.jackson.core:jackson-databind:2.15.3'
        implementation 'io.pebbletemplates:pebble:3.2.3'
    }

}

task scalaTest(type: JavaExec) {
    group = "verification"
    description = "Runs ScalaTest tests using the ScalaTest runner"

    classpath = sourceSets.test.runtimeClasspath
    mainClass.set("org.scalatest.tools.Runner")

    args = [
            "-R", "build/classes/scala/test",
            "-oD"
    ]
}
